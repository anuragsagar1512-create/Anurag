/* condensed from earlier, same as before */